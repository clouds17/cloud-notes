webpackJsonp([5],{Jdfc:function(t,n){t.exports={baseURL:"https://note-server.hunger-valley.com/"}},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("7+uW"),r=e("zL8q"),a=e.n(r),i=(e("tvR6"),e("Dd8w")),u=e.n(i),c=e("NYxO"),s={data:function(){return{}},computed:u()({},Object(c.c)(["username","slug"])),created:function(){}},d={render:function(){var t=this.$createElement;return(this._self._c||t)("span",{attrs:{title:this.username}},[this._v(this._s(this.slug))])},staticRenderFns:[]};var f={components:{avatar:e("VU/8")(s,d,!1,function(t){e("sItQ")},"data-v-6b883124",null).exports},methods:u()({},Object(c.b)(["logout_actions"]),{onLogout:function(){var t=this;this.logout_actions().then(function(){t.$router.push({path:"/login"})})}})},l={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{attrs:{id:"sidebar"}},[n("avatar"),this._v(" "),n("div",{staticClass:"icons"},[n("router-link",{attrs:{to:"/note",title:"笔记"}},[n("i",{staticClass:"iconfont icon-note"})]),this._v(" "),n("router-link",{attrs:{to:"/notebooks",title:"笔记本"}},[n("i",{staticClass:"iconfont icon-notebook"})]),this._v(" "),n("router-link",{attrs:{to:"/trash",title:"回收站"}},[n("i",{staticClass:"iconfont icon-trash"})])],1),this._v(" "),n("div",{staticClass:"logout",on:{click:this.onLogout}},[n("i",{staticClass:"iconfont icon-logout"})])],1)},staticRenderFns:[]};var h={name:"app",components:{sidebar:e("VU/8")(f,l,!1,function(t){e("fpUx")},"data-v-4fb7e797",null).exports}},p={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{attrs:{id:"app"}},[n("sidebar"),this._v(" "),n("router-view")],1)},staticRenderFns:[]};var b=e("VU/8")(h,p,!1,function(t){e("XBqS")},null,null).exports,m=e("//Fk"),k=e.n(m),v=e("mtWM"),N=e.n(v),I=e("Jdfc"),g=e.n(I);function T(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new k.a(function(o,a){var i={url:t,method:n,validateStatus:function(t){return t>=200&&t<300||400===t}};"get"===n.toLowerCase()?i.params=e:i.data=e,N()(i).then(function(t){200===t.status?o(t.data):(Object(r.Message)({message:t.data.msg,type:"error"}),a(t.data))}).catch(function(t){Object(r.Message)({message:t.data.msg,type:"error"}),a({msg:"网络异常"})})})}N.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",N.a.defaults.baseURL=g.a.baseURL,N.a.defaults.withCredentials=!0;var E="/auth/register",w="/auth/login",A="/auth/logout",_="/auth",D=function(t){var n=t.username,e=t.password;return T(E,"POST",{username:n,password:e})},L=function(t){var n=t.username,e=t.password;return T(w,"POST",{username:n,password:e})},U=function(){return T(A)},C=function(){return T(_)},F={state:{user:null},getters:{username:function(t){return null===t.user?"未登录":t.user.username},slug:function(t){return null===t.user?"未":t.user.username.charAt(0)}},mutations:{setUser:function(t,n){t.user=n.user}},actions:{logout_actions:function(t){var n=t.commit;return U().then(function(t){n("setUser",{user:null})})},login_actions:function(t,n){var e=t.commit,o=n.username,r=n.password;return new k.a(function(t,n){L({username:o,password:r}).then(function(n){e("setUser",{user:n.data}),t(n)}).catch(function(t){n(t)})})},register_actions:function(t,n){var e=t.commit,o=n.username,r=n.password;return new k.a(function(t,n){D({username:o,password:r}).then(function(n){e("setUser",{user:n.data}),t(n)}).catch(function(t){n(t)})})},checkLogin_actions:function(t){var n=t.commit;return new k.a(function(t,e){C().then(function(e){e.isLogin&&n("setUser",{user:e.data}),t(e)}).catch(function(t){e(t)})})}}},y=e("pFYg"),B=e.n(y);function P(t){var n=("object"===(void 0===t?"undefined":B()(t))?t:new Date(t)).getTime(),e=Date.now()-n,o="";switch(!0){case e<6e4:o="刚刚";break;case e<36e5:o=Math.floor(e/6e4)+"分钟前";break;case e<864e5:o=Math.floor(e/36e5)+"小时前";break;default:o=Math.floor(e/864e5)+"天前"}return o}var R={GET:"/notes/from/:notebookId",ADD:"/notes/to/:notebookId",UPDATE:"/notes/:noteId",DELETE:"/notes/:noteId"},O=function(t){var n=t.notebookId;return new k.a(function(t,e){T(R.GET.replace(":notebookId",n)).then(function(n){n.data=n.data.map(function(t){return t.createdAtFriendly=P(t.createdAt),t.updatedAtFriendly=P(t.updatedAt),t}).sort(function(t,n){return t.updatedAt>n.updatedAt?-1:1}),t(n)}).catch(function(t){e(t)})})},x=function(t){var n=t.notebookId,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:"",content:""},o=e.title,r=void 0===o?"":o,a=e.content,i=void 0===a?"":a;return new k.a(function(t,e){T(R.ADD.replace(":notebookId",n),"POST",{title:r,content:i}).then(function(n){n.data.createdAtFriendly=P(n.data.createdAt),n.data.updatedAtFriendly=P(n.data.updatedAt),t(n)}).catch(function(t){e(t)})})},G=function(t,n){var e=t.noteId,o=n.title,r=n.content;return T(R.UPDATE.replace(":noteId",e),"PATCH",{title:o,content:r})},S=function(t){var n=t.noteId;return T(R.DELETE.replace(":noteId",n),"DELETE")},M={state:{notes:null,curNoteId:null},getters:{notes:function(t){return t.notes||[]},curNote:function(t){return t.notes&&t.notes.length&&t.notes.find(function(n){return n.id==t.curNoteId})||{}}},mutations:{setNotes:function(t,n){t.notes=n.notes||[]},addNote:function(t,n){t.notes.unshift(n.notes)},updateNote:function(t,n){var e=t.notes.find(function(t){return t.id==n.noteId})||{};e.title=n.title,e.content=n.content},deleteNote:function(t,n){t.notes=t.notes.filter(function(t){return t.id!==n.noteId})},setCurNote:function(t,n){t.curNoteId=n.curNoteId}},actions:{getNotes_actions:function(t,n){var e=t.commit,o=n.notebookId;return new k.a(function(t,n){O({notebookId:o}).then(function(n){e("setNotes",{notes:n.data}),t(n)}).catch(function(t){n(t)})})},addNote_actions:function(t,n){var e=t.commit,o=n.notebookId,r=n.title,a=n.content;return new k.a(function(t,n){x({notebookId:o},{title:r,content:a}).then(function(n){e("addNote",{notes:n.data}),t(n)}).catch(function(t){n(t)})})},updateNote_actions:function(t,n){var e=t.commit,o=n.noteId,r=n.title,a=n.content;return new k.a(function(t,n){G({noteId:o},{title:r,content:a}).then(function(n){e("updateNote",{noteId:o,title:r,content:a}),t(n)}).catch(function(t){n(t)})})},deleteNote_actions:function(t,n){var e=t.commit,o=n.noteId;return new k.a(function(t,n){S({noteId:o}).then(function(n){e("deleteNote",{noteId:o}),t(n)}).catch(function(t){n(t)})})}}},j=e("bOdI"),H={GET:"/notebooks",ADD:"/notebooks",UPDATE:"/notebooks/:id",DELETE:"/notebooks/:id"},V=function(){return new k.a(function(t,n){T(H.GET).then(function(n){n.data=n.data.sort(function(t,n){return t.createdAt<n.createdAt?1:-1}),n.data.map(function(t){t.createdAtFriendly=P(t.createdAt),t.updatedAtFriendly=P(t.updatedAt)}),t(n)}).catch(function(t){n(t)})})},q=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{title:""}).title,n=void 0===t?"":t;return new k.a(function(t,e){T(H.ADD,"POST",{title:n}).then(function(n){n.data.createdAtFriendly=P(n.data.createdAt),n.data.updatedAtFriendly=P(n.data.updatedAt),t(n)}).catch(function(t){e(t)})})},J=function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:""}).title,e=void 0===n?"":n;return T(H.UPDATE.replace(":id",t),"PATCH",{title:e})},$=function(t){return T(H.DELETE.replace(":id",t),"DELETE")},Q={state:{notebooks:null,curBookId:null},getters:{notebooks:function(t){return t.notebooks||[]},curBook:function(t){return t.notebooks&&t.notebooks.length?t.curBookId?t.notebooks.find(function(n){return n.id==t.curBookId}):t.notebooks[0]:{}}},mutations:e.n(j)()({setNotebooks:function(t,n){t.notebooks=n.notebooks||[]},addNotebook:function(t,n){t.notebooks.unshift(n.notebooks)},updateNotebook:function(t,n){(t.notebooks.find(function(t){return t.id==n.notebookId})||{}).title=n.title},deleteNotebook:function(t,n){t.notebooks=t.notebooks.filter(function(t){return t.id!==n.notebookId})},setCurBook:function(t,n){t.curBook=t.notebooks.filter(function(t){return t.id==n.notebookId})||t.notebooks[0]||{title:"我的笔记本"}}},"setCurBook",function(t,n){t.curBookId=n.curBookId}),actions:{getNotebooks_actions:function(t){var n=t.commit,e=t.state,o=t.getters;return null!==e.notebooks?k.a.resolve(o.notebooks):new k.a(function(t,e){V().then(function(e){n("setNotebooks",{notebooks:e.data}),t(e)}).catch(function(t){e(t)})})},addNotebook_actions:function(t,n){var e=t.commit;return new k.a(function(t,o){q({title:n.title}).then(function(n){e("addNotebook",{notebooks:n.data}),t(n)}).catch(function(t){o(t)})})},updateNotebook_actions:function(t,n){var e=t.commit;return new k.a(function(t,o){J(n.notebookId,{title:n.title}).then(function(o){e("updateNotebook",n),t(o)}).catch(function(t){o(t)})})},deleteNotebook_actions:function(t,n){var e=t.commit;return new k.a(function(t,o){$(n.notebookId).then(function(o){e("deleteNotebook",n),t(o)}).catch(function(t){o(t)})})}}},W={GET:"/notes/trash",REVERT:"/notes/:noteId/revert",DELETE:"/notes/:noteId/confirm"},X=function(){return new k.a(function(t,n){T(W.GET).then(function(n){n.data=n.data.map(function(t){return t.createdAtFriendly=P(t.createdAt),t.updatedAtFriendly=P(t.updatedAt),t}).sort(function(t,n){return t.updatedAt>n.updatedAt?-1:1}),t(n)}).catch(function(t){n(t)})})},Y=function(t){var n=t.noteId;return T(W.REVERT.replace(":noteId",n),"PATCH")},z=function(t){var n=t.noteId;return T(W.DELETE.replace(":noteId",n),"DELETE")},K={state:{trashNotes:null,curTrashNoteId:null},getters:{trashNotes:function(t){return t.trashNotes||[]},curTrashNote:function(t,n){return n.trashNotes.length&&t.trashNotes.find(function(n){return n.id==t.curTrashNoteId})||{}},belongTo:function(t,n){return(n.notebooks.find(function(t){return t.id==n.curTrashNote.notebookId})||{}).title||""}},mutations:{setTrashNotes:function(t,n){t.trashNotes=n.trashNote||[]},addTrashNote:function(t,n){t.trashNotes.unshift(n.trashNote)},deleteTrashNote:function(t,n){t.trashNotes=t.trashNotes.filter(function(t){return t.id!==n.noteId})},setCurTrashNote:function(t,n){t.curTrashNoteId=n.curTrashNoteId}},actions:{getTrash_actions:function(t){var n=t.commit;return new k.a(function(t,e){X().then(function(e){n("setTrashNotes",{trashNote:e.data}),t(e)}).catch(function(t){e(t)})})},deleteTrash_actions:function(t,n){var e=t.commit,o=n.noteId;return new k.a(function(t,n){z({noteId:o}).then(function(n){e("deleteTrashNote",{noteId:o}),t(n)}).catch(function(t){n(t)})})},revertTrash_actions:function(t,n){var e=t.commit,o=n.noteId;return new k.a(function(t,n){Y({noteId:o}).then(function(n){e("deleteTrashNote",{noteId:o}),t(n)}).catch(function(t){n(t)})})}}};o.default.use(c.a);var Z=new c.a.Store({modules:{User:F,Note:M,NoteBook:Q,Trash:K}}),tt=e("/ocq");o.default.use(tt.a);var nt=new tt.a({routes:[{path:"/login",component:function(){return e.e(3).then(e.bind(null,"xJsL"))}},{path:"/notebooks",alias:"/",component:function(){return e.e(2).then(e.bind(null,"C3fl"))}},{path:"/note",component:function(){return e.e(0).then(e.bind(null,"Gb2o"))}},{path:"/trash",component:function(){return e.e(1).then(e.bind(null,"8E/F"))}}]});nt.beforeEach(function(t,n,e){"/login"===t.path?(console.log("要去登录页"),e()):Z.dispatch("checkLogin_actions").then(function(t){t.isLogin?(console.log("原来登录了丫"),e()):(console.log("哦吼，还没登录哄"),e("/login"))})});var et=nt;o.default.config.productionTip=!1,o.default.use(a.a),new o.default({el:"#app",router:et,store:Z,components:{App:b},template:"<App/>"})},XBqS:function(t,n){},fpUx:function(t,n){},sItQ:function(t,n){},tvR6:function(t,n){}},["NHnr"]);
//# sourceMappingURL=app.2f5302330766fa04e6be.js.map